import{a1 as r,k as m,a2 as o,a4 as u,a5 as i,z as e,i as c,s as y}from"./index-CKwFapHy.js";const l={post:{createPayment:async a=>(await r.post("/Payment/create-payment-link",a)).data}},d=()=>{const{toast:a}=m(),n=new o;return{createPaymentMutation:u({mutationKey:[i.PAYMENT.CREATE_PAYMENT_LINK],mutationFn:async t=>await l.post.createPayment(t),onSuccess:async t=>{t!=null&&t.checkoutUrl?setTimeout(()=>{window.location.href=t.checkoutUrl},1e3):a({title:"Payment created",description:t.message||"Payment processing initiated",variant:"success"})},onSettled:()=>{n.invalidateQueries({queryKey:[i.PAYMENT.CREATE_PAYMENT_LINK]})}})}},P=e.object({courseId:e.number().positive("Course ID must be a positive number").int("Course ID must be an integer"),name:e.string().min(1,"Course name is required").max(200,"Course name must not exceed 200 characters").trim(),quantity:e.number().min(1,"Quantity must be at least 1").max(10,"Maximum quantity is 10").int("Quantity must be an integer"),price:e.number().min(0,"Price must be 0 or greater").max(1e8,"Price exceeds maximum limit")}),b=e.object({buyerName:e.string().min(2,"Buyer name must be at least 2 characters").max(100,"Buyer name must not exceed 100 characters").regex(/^[a-zA-ZÀ-ỹ\s]+$/,"Buyer name can only contain letters and spaces").trim(),buyerEmail:e.string().email("Please enter a valid email address").min(1,"Email is required").max(254,"Email address is too long").toLowerCase().trim(),buyerPhone:e.string().min(10,"Phone number must be at least 10 digits").max(15,"Phone number must not exceed 15 digits").regex(/^[\+]?[0-9\s\-\(\)]+$/,"Please enter a valid phone number").trim(),description:e.string().min(1,"Description is required").max(500,"Description must not exceed 500 characters").trim(),items:e.array(P).min(1,"At least one item is required").max(10,"Maximum 10 items allowed").refine(a=>{const n=a.map(s=>s.courseId);return n.length===new Set(n).size},"Duplicate courses are not allowed")}),x=()=>{const{createPaymentMutation:a}=d(),n=c({resolver:y(b),defaultValues:{buyerName:"",buyerEmail:"",buyerPhone:"0365666666",description:"thanh toan khoa hoc",items:[{courseId:0,name:"",quantity:1,price:0}]}});return{form:n,onSubmit:async t=>{await a.mutateAsync(t),n.reset()},isLoading:a.isPending}};export{x as u};
