import{r as c,j as e,W as k,X as A,Y as R,Z as M,_ as C,$ as V,a0 as Q,a1 as Y,a2 as _,b as B,a3 as P,a4 as I,a5 as T,a6 as D,C as G,I as b,a7 as H,a8 as u,a9 as v,aa as q,T as $,S as K,w as E}from"./index-B1yiEii3.js";import{u as W}from"./use-auth-C4kr9cW_.js";import{C as X}from"./camera-BVBfU-zb.js";import{C as Z}from"./circle-alert-278jLJkD.js";import{C as J}from"./crown-D6N-C8ou.js";var ee="Separator",F="horizontal",ae=["horizontal","vertical"],L=c.forwardRef((a,n)=>{const{decorative:r,orientation:i=F,...l}=a,d=te(i)?i:F,m=r?{role:"none"}:{"aria-orientation":d==="vertical"?d:void 0,role:"separator"};return e.jsx(k.div,{"data-orientation":d,...m,...l,ref:n})});L.displayName=ee;function te(a){return ae.includes(a)}var re=L;function se({className:a,orientation:n="horizontal",decorative:r=!0,...i}){return e.jsx(re,{"data-slot":"separator-root",decorative:r,orientation:n,className:A("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",a),...i})}const ie=M("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function h({className:a,variant:n,asChild:r=!1,...i}){const l=r?R:"span";return e.jsx(l,{"data-slot":"badge",className:A(ie({variant:n}),a),...i})}const ne={get:{getAll:async()=>(await C.get("/users")).data,getPremium:async()=>(await C.get("/users/premium-status")).data}},le=()=>(V(),new Q,{getPremiumStatusQuery:Y({queryKey:[_.GET_PREMIUM_STATUS],queryFn:async()=>await ne.get.getPremium()})});function oe(){var w,S;const{user:a,login:n}=B(),{toast:r}=V(),{useSendVerifyEmail:i}=W(),{getPremiumStatusQuery:l}=le(),d=i(),[g,m]=c.useState(!1),[y,j]=c.useState(!1),[s,f]=c.useState({name:(a==null?void 0:a.name)||"",email:(a==null?void 0:a.email)||"",gender:(a==null?void 0:a.gender)!==void 0?a==null?void 0:a.gender.toString():"",birthday:a!=null&&a.birthday?new Date(a.birthday).toISOString().split("T")[0]:""});c.useEffect(()=>{a&&f({name:a.name||"",email:a.email||"",gender:a.gender!==void 0?a.gender.toString():"",birthday:a.birthday?new Date(a.birthday).toISOString().split("T")[0]:""})},[a]);const p=t=>{const{name:o,value:x}=t.target;f({...s,[o]:x})},O=async t=>{t.preventDefault(),j(!0);try{const o={...a,fullName:s.name,gender:s.gender!==""?parseInt(s.gender):void 0,birthday:s.birthday};await n(o),r({title:"Profile updated",description:"Your profile information has been updated successfully.",variant:"success"})}catch(o){r({title:"Update failed",description:o.message||"Failed to update profile information.",variant:"destructive"})}finally{j(!1)}},U=async()=>{m(!0);try{const t=await d.refetch();r({title:"Verification email sent",description:t.data.data,variant:"success"})}catch(t){r({title:"Failed to send verification email",description:t.message||"Something went wrong. Please try again.",variant:"destructive"})}finally{m(!1)}},N=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),z=()=>{var x;const t=(x=l.data)==null?void 0:x.data;return l.isLoading?e.jsx("div",{className:"w-full mb-4",children:e.jsxs("div",{className:"bg-gray-100 rounded-lg p-3 animate-pulse",children:[e.jsx("div",{className:"h-4 bg-gray-300 rounded mb-2"}),e.jsx("div",{className:"h-3 bg-gray-300 rounded"})]})}):!t||(a==null?void 0:a.premium)==="FreeTier"?e.jsx("div",{className:"w-full mb-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 border border-gray-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-gray-400 rounded-full"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Free Tier"})]}),e.jsx(h,{variant:"secondary",className:"bg-gray-100 text-gray-600 text-xs",children:"Current Plan"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Basic access to courses and features"})]})}):e.jsx("div",{className:"w-full mb-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(J,{className:"w-4 h-4 text-amber-500"}),e.jsx("span",{className:"text-sm font-medium text-amber-800",children:"Premium Member"})]}),e.jsxs(h,{className:"bg-amber-500 text-white text-xs",children:[e.jsx(K,{className:"w-3 h-3 mr-1"}),t.status]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-amber-700",children:[e.jsx(E,{className:"w-3 h-3"}),e.jsxs("span",{children:["Subscribed: ",N(t.subcriptionAt)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-amber-700",children:[e.jsx(E,{className:"w-3 h-3"}),e.jsxs("span",{children:["Valid until: ",N(t.endDate)]})]})]}),e.jsx("p",{className:"text-xs text-amber-600 mt-2",children:"Full access to all courses and exclusive content"}),new Date(t.endDate)-new Date<7*24*60*60*1e3&&e.jsx("div",{className:"mt-2 p-2 bg-orange-100 border border-orange-200 rounded text-xs text-orange-700",children:"⚠️ Your premium subscription expires soon!"})]})})};return e.jsxs("div",{className:"container mx-auto max-w-2xl py-10 px-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-primary-yellow mb-6",children:"My Profile"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-7",children:[e.jsxs(P,{className:"w-full md:w-1/3",children:[e.jsx(I,{children:e.jsx(T,{children:"Profile Photo"})}),e.jsxs(D,{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative w-32 h-32 rounded-full overflow-hidden bg-amber-50 mb-4",children:[a!=null&&a.avatar?e.jsx("img",{src:a.avatar,alt:"Profile",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-amber-100 text-amber-800 text-2xl font-bold",children:((S=(w=a==null?void 0:a.name)==null?void 0:w.charAt(0))==null?void 0:S.toUpperCase())||"U"}),e.jsx("button",{className:"absolute bottom-0 right-0 p-1.5 bg-primary-yellow rounded-full text-white",children:e.jsx(X,{size:16})})]}),e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("p",{className:"font-medium text-lg",children:a==null?void 0:a.name}),e.jsx("p",{className:"text-gray-600",children:a==null?void 0:a.email})]}),z(),e.jsx("div",{className:"w-full text-center",children:(a==null?void 0:a.status)===0?e.jsxs(h,{className:"bg-green-600",children:[e.jsx(G,{size:14,className:"mr-1"}),"Verified"]}):e.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[e.jsxs(h,{className:"bg-primary-yellow",children:[e.jsx(Z,{size:14,className:"mr-1"}),"Verification Required"]}),e.jsx(b,{variant:"link",size:"sm",onClick:U,className:"text-primary-blue hover:text-primary-yellow p-0 h-auto",disabled:g,children:g?"Sending...":"Send verification email"})]})})]})]}),e.jsxs(P,{className:"w-full md:w-2/3",children:[e.jsxs(I,{children:[e.jsx(T,{children:"Personal Information"}),e.jsx(H,{children:"Update your personal information and how others see you on the platform."})]}),e.jsxs("form",{onSubmit:O,children:[e.jsx(D,{className:"space-y-4 gap-2 px-4 py-6",children:e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"name",children:"Full Name"}),e.jsx(v,{id:"name",name:"name",placeholder:"Your name",value:s.name,onChange:p})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"email",children:"Email Address"}),e.jsx(v,{id:"email",name:"email",type:"email",placeholder:"Your email",value:s.email,disabled:!0}),e.jsx("p",{className:"text-xs text-gray-500",children:"Email address cannot be changed."})]}),e.jsx(se,{className:"my-2"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"gender",children:"Gender"}),e.jsxs("select",{id:"gender",name:"gender",value:s.gender,onChange:p,className:"w-full px-3 py-2 border border-gray-300 rounded-md",children:[e.jsx("option",{value:"",children:"Select gender"}),e.jsx("option",{value:"0",children:"Male"}),e.jsx("option",{value:"1",children:"Female"}),e.jsx("option",{value:"2",children:"Other"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"birthday",children:"Birthday"}),e.jsx(v,{id:"birthday",name:"birthday",type:"date",value:s.birthday,onChange:p})]})]})}),e.jsxs(q,{className:"flex justify-end space-x-2 gap-2",children:[e.jsx(b,{type:"button",variant:"outline",onClick:()=>f({name:(a==null?void 0:a.name)||"",email:(a==null?void 0:a.email)||"",gender:(a==null?void 0:a.gender)!==void 0?a==null?void 0:a.gender.toString():"",birthday:a!=null&&a.birthday?new Date(a.birthday).toISOString().split("T")[0]:""}),children:"Cancel"}),e.jsx(b,{type:"submit",disabled:y,className:`${$.HIGHLIGHT_FRAME} rounded-md cursor-pointer`,children:y?"Saving...":"Save changes"})]})]})]})]})]})}function he(){return e.jsx(oe,{})}export{he as default};
