import{r as v,j as g}from"./index-BNUT8_4B.js";var I=new Map,w=new WeakMap,E=0,C=void 0;function z(e){return e?(w.has(e)||(E+=1,w.set(e,E.toString())),w.get(e)):"0"}function L(e){return Object.keys(e).sort().filter(t=>e[t]!==void 0).map(t=>`${t}_${t==="root"?z(e.root):e[t]}`).toString()}function V(e){const t=L(e);let o=I.get(t);if(!o){const i=new Map;let c;const n=new IntersectionObserver(s=>{s.forEach(r=>{var a;const l=r.isIntersecting&&c.some(u=>r.intersectionRatio>=u);e.trackVisibility&&typeof r.isVisible>"u"&&(r.isVisible=l),(a=i.get(r.target))==null||a.forEach(u=>{u(l,r)})})},e);c=n.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),o={id:t,observer:n,elements:i},I.set(t,o)}return o}function $(e,t,o={},i=C){if(typeof window.IntersectionObserver>"u"&&i!==void 0){const a=e.getBoundingClientRect();return t(i,{isIntersecting:i,target:e,intersectionRatio:typeof o.threshold=="number"?o.threshold:0,time:0,boundingClientRect:a,intersectionRect:a,rootBounds:a}),()=>{}}const{id:c,observer:n,elements:s}=V(o),r=s.get(e)||[];return s.has(e)||s.set(e,r),r.push(t),n.observe(e),function(){r.splice(r.indexOf(t),1),r.length===0&&(s.delete(e),n.unobserve(e)),s.size===0&&(n.disconnect(),I.delete(c))}}function A({threshold:e,delay:t,trackVisibility:o,rootMargin:i,root:c,triggerOnce:n,skip:s,initialInView:r,fallbackInView:a,onChange:l}={}){var u;const[h,p]=v.useState(null),x=v.useRef(l),[f,m]=v.useState({inView:!!r,entry:void 0});x.current=l,v.useEffect(()=>{if(s||!h)return;let y;return y=$(h,(R,S)=>{m({inView:R,entry:S}),x.current&&x.current(R,S),S.isIntersecting&&n&&y&&(y(),y=void 0)},{root:c,rootMargin:i,threshold:e,trackVisibility:o,delay:t},a),()=>{y&&y()}},[Array.isArray(e)?e.toString():e,h,c,i,n,s,o,a,t]);const b=(u=f.entry)==null?void 0:u.target,j=v.useRef(void 0);!h&&b&&!n&&!s&&j.current!==b&&(j.current=b,m({inView:!!r,entry:void 0}));const d=[p,f.inView,f.entry];return d.ref=d[0],d.inView=d[1],d.entry=d[2],d}function F({src:e,alt:t,className:o="",placeholder:i=null,width:c,height:n,style:s={},threshold:r=.1,rootMargin:a="100px",...l}){const{ref:u,inView:h}=A({triggerOnce:!0,threshold:r,rootMargin:a}),[p,x]=v.useState(!1),[f,m]=v.useState(!1),b=()=>{x(!0),console.log(`✅ Image loaded: ${e}`)},j=()=>{m(!0),console.log(`❌ Image failed: ${e}`)},d={width:c||"100%",height:n||"auto",display:"block",...s};return g.jsx("div",{ref:u,className:`lazy-image-container ${o}`,style:d,children:h?g.jsxs(g.Fragment,{children:[g.jsx("img",{src:e,alt:t,onLoad:b,onError:j,style:{width:"100%",height:"100%",objectFit:"cover",opacity:p?1:0,transition:"opacity 0.3s ease",display:f?"none":"block"},...l}),!p&&!f&&(i||g.jsx("div",{style:{width:"100%",height:n||"200px",backgroundColor:"#f0f0f0",display:"flex",alignItems:"center",justifyContent:"center",color:"#666",fontSize:"14px"},children:"Loading image..."})),f&&g.jsx("div",{style:{width:"100%",height:n||"200px",backgroundColor:"#fee",display:"flex",alignItems:"center",justifyContent:"center",color:"#c66",fontSize:"14px"},children:"Failed to load image"})]}):i||g.jsx("div",{style:{width:"100%",height:n||"200px",backgroundColor:"#f8f8f8",display:"flex",alignItems:"center",justifyContent:"center",color:"#999",fontSize:"14px",border:"1px dashed #ddd"},children:"Scroll to load image"})})}export{F as L};
