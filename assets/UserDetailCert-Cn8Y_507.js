import{d as O,l as _,c as Z,b as H,K as Q,aB as Y,r as u,j as e,x as d,Y as l,Z as C,L as J,e as K,k as g,aA as k,N as P,y as V,f as X,aa as q,ab as G,ac as W,B as ee,ad as se,J as ae,a8 as te}from"./index-LkxAMlZb.js";import{B as ie}from"./badge-CzlvzCYH.js";import{S as I}from"./share-2-C1K3VI61.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],L=O("zoom-in",le);function oe(){var b;const{certificateId:U}=_(),j=Z(),{user:r}=H(),{getCertificateByIdQuery:D}=Q(),{getModuleQuery:S}=Y(),{data:c,isLoading:E,error:M}=D(U),$=(b=c==null?void 0:c.data)==null?void 0:b.courseId,{data:m,isLoading:z,error:B}=S($),[x,p]=u.useState(!1),[n,y]=u.useState(!1),s=c==null?void 0:c.data,N=(m==null?void 0:m.data)||[],A=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),R=a=>{const t=new Date,o=new Date(a),i=Math.floor((t-o)/(1e3*60*60*24));return i===0?"Today":i===1?"Yesterday":i<30?`${i} days ago`:i<365?`${Math.floor(i/30)} months ago`:`${Math.floor(i/365)} years ago`},w=async()=>{if(s!=null&&s.certificateImageUrl)try{y(!0),console.log("ðŸ”½ Starting certificate download:",s.courseName);const a=await fetch(s.certificateImageUrl,{mode:"cors"});if(!a.ok)throw new Error(`Failed to fetch certificate: ${a.statusText}`);const t=await a.blob(),o=window.URL.createObjectURL(t),i=document.createElement("a");i.href=o;const T=s.courseName.replace(/[^a-zA-Z0-9\s]/g,"").replace(/\s+/g,"_").trim(),F=s.certificateImageUrl.split(".").pop()||"jpg";i.download=`${T}_Certificate.${F}`,document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(o),console.log("âœ… Certificate downloaded successfully")}catch(a){console.error("âŒ Download failed:",a),console.log("ðŸ”„ Trying fallback download method...");const t=document.createElement("a");t.href=s.certificateImageUrl,t.download=`${s.courseName.replace(/[^a-zA-Z0-9\s]/g,"").replace(/\s+/g,"_")}_Certificate.jpg`,t.target="_blank",document.body.appendChild(t),t.click(),document.body.removeChild(t)}finally{y(!1)}},v=async()=>{if(navigator.share&&s)try{await navigator.share({title:`${s.courseName} Certificate`,text:`I've completed the ${s.courseName} course and earned a certificate!`,url:s.certificateImageUrl})}catch(a){console.log("Error sharing:",a)}else if(s)try{await navigator.clipboard.writeText(s.certificateImageUrl),console.log("ðŸ“‹ Certificate URL copied to clipboard")}catch(a){console.error("Failed to copy to clipboard:",a)}},h=()=>{console.log("ðŸ–¼ï¸ Opening certificate modal"),p(!0)},f=()=>{console.log("âŒ Closing certificate modal"),p(!1)};return u.useEffect(()=>{const a=t=>{t.key==="Escape"&&f()};return x&&(document.addEventListener("keydown",a),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",a),document.body.style.overflow="unset"}},[x]),E?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-amber-50",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx(d,{className:"h-12 w-12 animate-spin text-primary-yellow mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Loading Certificate Details"}),e.jsx("p",{className:"text-gray-500",children:"Fetching your certificate information..."})]})})})}):M||!s?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-red-50 to-orange-50",children:e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-red-500 text-6xl mb-4",children:"âš ï¸"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-2",children:"Certificate Not Found"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"The certificate you're looking for doesn't exist or you don't have permission to view it."}),e.jsxs(l,{onClick:()=>j("/certificate"),className:"bg-primary-yellow hover:bg-secondary-yellow text-white",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Back to Certificates"]})]})})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-amber-50",children:e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6 text-sm text-gray-600",children:[e.jsx(J,{to:"/certificate",className:"hover:text-primary-yellow transition-colors",children:"Certificates"}),e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{className:"text-gray-800 font-medium",children:s.courseName})]}),e.jsxs(l,{variant:"outline",onClick:()=>j("/certificate"),className:"mb-6",children:[e.jsx(C,{className:"w-4 h-4 mr-2"}),"Back to Certificates"]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden mb-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-yellow-400 to-orange-500 p-6",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center",children:e.jsx(g,{className:"w-8 h-8 text-yellow-500"})}),e.jsxs("div",{className:"text-white",children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:"Certificate of Completion"}),e.jsx("p",{className:"text-yellow-100",children:"Congratulations on completing your course!"})]})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:s.certificateImageUrl,alt:`${s.courseName} Certificate`,className:"w-full rounded-lg shadow-lg cursor-pointer transition-transform hover:scale-105",onClick:h}),e.jsx("div",{className:"absolute inset-0 hover:bg-[#00000052] bg-opacity-0 hover:bg-opacity-30 transition-all duration-200 rounded-lg flex items-center justify-center cursor-pointer",onClick:h,children:e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity bg-white px-4 py-2 rounded-full text-sm font-medium flex items-center space-x-2",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{children:"Click to view full size"})]})})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs(l,{onClick:w,disabled:n,className:"flex-1 bg-primary-yellow hover:bg-secondary-yellow text-white disabled:opacity-50",children:[n?e.jsx(d,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(k,{className:"w-4 h-4 mr-2"}),n?"Downloading...":"Download Certificate"]}),e.jsxs(l,{variant:"outline",onClick:v,className:"flex-1",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Share"]})]}),e.jsxs(l,{variant:"outline",onClick:h,className:"w-full flex items-center justify-center space-x-2",children:[e.jsx(L,{className:"w-4 h-4"}),e.jsx("span",{children:"View Full Size"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-2",children:s.courseName}),e.jsxs(ie,{variant:"secondary",className:"mb-4",children:["Certificate ID: ",s.certificateId]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(P,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Awarded to"}),e.jsx("p",{className:"font-semibold text-gray-800",children:(r==null?void 0:r.fullName)||(r==null?void 0:r.email)||"Student"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:e.jsx(V,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Completed on"}),e.jsx("p",{className:"font-semibold text-gray-800",children:A(s.completedAt)})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:e.jsx(X,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Achievement time"}),e.jsx("p",{className:"font-semibold text-gray-800",children:R(s.completedAt)})]})]}),s.completedIn&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx(g,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Course duration"}),e.jsx("p",{className:"font-semibold text-gray-800",children:s.completedIn})]})]})]})]})]})})]}),e.jsxs(q,{children:[e.jsxs(G,{children:[e.jsxs(W,{className:"flex items-center space-x-2",children:[e.jsx(ee,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{children:"Course Modules Completed"})]}),e.jsx("p",{className:"text-gray-600",children:"Here are the modules you completed to earn this certificate"})]}),e.jsx(se,{children:z?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(d,{className:"h-8 w-8 animate-spin text-primary-yellow mr-3"}),e.jsx("span",{className:"text-gray-600",children:"Loading course modules..."})]}):B?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 text-4xl mb-4",children:"ðŸ“š"}),e.jsx("p",{className:"text-gray-600",children:"Unable to load course modules"})]}):N.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 text-4xl mb-4",children:"ðŸ“"}),e.jsx("p",{className:"text-gray-600",children:"No modules found for this course"})]}):e.jsx("div",{className:"space-y-3",children:N.map((a,t)=>e.jsxs("div",{className:"flex items-center space-x-4 p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center text-sm font-bold",children:t+1})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-800",children:a.title||`Module ${t+1}`}),a.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.description})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ae,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"text-sm text-green-600 font-medium",children:"Completed"})]})]},a.id))})})]}),x&&e.jsxs("div",{className:"fixed inset-0 z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-[#00000052] bg-opacity-80",onClick:f}),e.jsx("div",{className:"relative z-10 flex items-center justify-center min-h-screen p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-[95vh] overflow-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-4 flex justify-between items-center z-20",children:[e.jsxs("h3",{className:"text-lg font-semibold flex items-center space-x-2",children:[e.jsx(g,{className:"w-5 h-5 text-yellow-500"}),e.jsxs("span",{children:[s.courseName," Certificate"]})]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:f,className:"flex items-center space-x-1",children:[e.jsx(te,{className:"w-4 h-4"}),e.jsx("span",{children:"Close"})]})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"text-center mb-4",children:e.jsx("p",{className:"text-sm text-gray-600",children:'Right-click and "Save image as..." or use the download button below'})}),e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("img",{src:s.certificateImageUrl,alt:`${s.courseName} Certificate`,className:"max-w-full h-auto rounded-lg shadow-lg",style:{maxHeight:"70vh"}})}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsxs(l,{onClick:w,disabled:n,className:"bg-primary-yellow hover:bg-secondary-yellow text-white disabled:opacity-50",children:[n?e.jsx(d,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(k,{className:"w-4 h-4 mr-2"}),n?"Downloading...":"Download Full Size"]}),e.jsxs(l,{variant:"outline",onClick:v,children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Share Certificate"]})]})]})]})})]})]})})}export{oe as default};
